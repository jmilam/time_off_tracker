<div class="container">
<!--   <%#= month_calendar do |date| %>
      <%#= date %>
    <%# end %> -->
  <div class="row">
    <div class="col-sm-12 col-md-10 col-md-offset-1">
      <div class="panel panel-success">
        <div class="panel-heading">
          <div class="panel-title">
            Available Time Overview
          </div>
        </div>
        <div class="panel-body">
          <ul class="list-inline text-center">
            <li class="col-sm-12 col-md-6 right-border">
              <b>Vaction Hours</b>
              <ul class="list-inline">
                <li class="col-sm-12 col-md-4">Available</li>
                <li class="col-sm-12 col-md-4">Used</li>
                <li class="col-sm-12 col-md-4">Pending</li>
              </ul>
              <ul class="list-inline">
                <li class="col-sm-12 col-md-4"><%= @user.vacation_total - @used_vac - @pending_vac_total %></li>
                <li class="col-sm-12 col-md-4"><%= @used_vac %></li>
                <li class="col-sm-12 col-md-4"><%= @pending_vac_total %></li>
              </ul>
            </li>
            <li class="col-sm-12 col-md-6">
              <b>Personal Hours</b>
              <ul class="list-inline">
                <li class="col-sm-12 col-md-4">Available</li>
                <li class="col-sm-12 col-md-4">Used</li>
                <li class="col-sm-12 col-md-4">Pending</li>
              </ul>
              <ul class="list-inline">
                <li class="col-sm-12 col-md-4"><%= @user.personal_total - @used_personal - @pending_personal_total %></li>
                <li class="col-sm-12 col-md-4"><%= @used_personal %></li>
                <li class="col-sm-12 col-md-4"><%= @pending_personal_total %></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
  </div>
	<div class="row">
    <div class="col-sm-12 col-md-10 col-md-offset-1">
	    <div class="panel panel-primary" >
	      <div class="panel-heading" >
	        <div class="panel-title" >
	          My Vacation Request's
	        	<%= link_to "New Request", new_time_off_request_path, class: "pull-right" %>
	        </div>
	      </div>
	  		<div class="panel-body" %>
          <% if @user.time_off_requests.count == 0 %>
            <div class="jumbotron">
              <p class="text-center">You have no Time Off Requests Pending.</p>
            </div>
          <% else %>
  	     		<table class="table table-striped" >
  	     			<thead>
  		     			<tr>
  		          	<th>Name </th>
  		          	<th>Request Type</th>
  		          	<th>Start Date</th>
  		          	<th>End Date</th>
  		          	<th>Approved</th>
  		          	<th></th>
  		          </tr>
  		        </thead>
  		       	<tbody>
  		       		<% @time_requests.each do |t_request| %>
                  <% t_request.each do |request| %>

  								<tr>
  									<td><%= @user.first_name %> <%= @user.last_name %></td>
  									<td><%= request.time_off_type %></td>
  									<td><%= request.date_start.strftime('%m-%d-%Y') %></td>
  									<td><%= request.date_end.strftime('%m-%d-%Y') %></td>
  									<td><%= request.status %></td>
  									<td><%= link_to 'Cancel', time_off_request_cancel_path(id: request.id), method: :put, data: {confirm: "Are you sure you want to cancel this request. You will not be able to restore this request. You will have to make the request again."} unless request.cancelled || request.approved == false %></td>
  								</tr>
                  <% end %>
  							<% end %>
  		       	</tbody>
  	        </table>
          <% end %>
	      </div>
		  </div>
    </div>
	</div>

  <% if @user.admin? %>
  	<div class="row">
      <div class="col-sm-12 col-md-10 col-md-offset-1">
        <div class="panel panel-danger" >
          <div class="panel-heading" >
            <div class="panel-title" >
              Employee Vacation Request's Waiting for your Approval
            </div>
          </div>
          <div class="panel-body" %>
            <% if @user.time_off_requests.count == 0 %>
              <div class="jumbotron">
                <p class="text-center">You have no Time Off Requests Pending.</p>
              </div>
            <% else %>
              <table class="table table-striped" >
                <thead>
                  <tr>
                    <th>Name </th>
                    <th>Request Type</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Hours</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <% @manager_approvals.each do |request| %>
                    <tr>
                      <td><%= request.user.first_name %> <%= request.user.last_name %></td>
                      <td><%= request.time_off_type %></td>
                      <td><%= request.date_start.strftime('%m-%d-%Y') %></td>
                      <td><%= request.date_end.strftime('%m-%d-%Y') %></td>
                      <td><%= request.hours %></td>
                      <td><%= link_to "Approve", time_off_request_path(id: request.id, status: "approved"), method: :put, class: 'btn btn-success' %> <%= link_to "Deny", time_off_request_path(id: request.id, status: "denied"), method: :put, class: 'btn btn-danger' %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            <% end %>
          </div>
        </div>
    	</div>
    </div> 

    <div class="row">
      <div class="col-sm-12 col-md-10 col-md-offset-1">
        <div class="panel panel-warning" >
          <div class="panel-heading" >
            <div class="panel-title" >
              Department Employee Time Off Details
            </div>
          </div>
          <div class="panel-body" %>
            <% if @employees.count == 0 %>
              <div class="jumbotron">
                <p class="text-center">You have no employees under you.</p>
              </div>
            <% else %>
              <table class="table table-striped" >
                <thead>
                  <tr style="background-color:lightgray;">
                    <th></th>
                    <th colspan=3 class="text-center">Vacation Time (Hours)</th>
                    <th colspan=3 class="text-center">Personal Time (Hours)</th>
                  </tr>
                  <tr style="background-color:lightyellow;">
                    <th>Name </th>
                    <th class="text-center">Available</th>
                    <th class="text-center">Used</th>
                    <th class="text-center">Pending</th>
                    <th class="text-center">Available</th>
                    <th class="text-center">Used</th>
                    <th class="text-center">Pending</th>
                  </tr>
                </thead>
                <tbody>
                  <% @employees.each do |emp| %>
                    <tr>
                      <td><%= emp.first_name %> <%= emp.last_name %></td>
                      <% emp = emp.user_totals %>
                      <td class="text-center"><%= emp[:vacation][:available] %></td>
                      <td class="text-center"><%= emp[:vacation][:used] %></td>
                      <td class="text-center"><%= emp[:vacation][:pending] %></td>
                      <td class="text-center"><%= emp[:personal][:available] %></td>
                      <td class="text-center"><%= emp[:personal][:used] %></td>
                      <td class="text-center"><%= emp[:personal][:pending] %></td>

                    </tr>
                  <% end %>
                </tbody>
              </table>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>